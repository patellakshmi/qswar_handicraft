CREATE TABLE `SPRING_SESSION` (
  `PRIMARY_ID` CHAR(36) NOT NULL,
  `SESSION_ID` CHAR(36) NOT NULL,
  `CREATION_TIME` BIGINT NOT NULL,
  `LAST_ACCESS_TIME` BIGINT NOT NULL,
  `MAX_INACTIVE_INTERVAL` INT NOT NULL,
  `EXPIRY_TIME` BIGINT NOT NULL,
  `PRINCIPAL_NAME` VARCHAR(100) DEFAULT NULL,
  PRIMARY KEY (`PRIMARY_ID`),
  UNIQUE KEY `SPRING_SESSION_IX1` (`SESSION_ID`),
  KEY `SPRING_SESSION_IX2` (`EXPIRY_TIME`),
  KEY `SPRING_SESSION_IX3` (`PRINCIPAL_NAME`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


CREATE TABLE `SPRING_SESSION_ATTRIBUTES` (
  `SESSION_PRIMARY_ID` CHAR(36) NOT NULL,
  `ATTRIBUTE_NAME` VARCHAR(200) NOT NULL,
  `ATTRIBUTE_BYTES` BLOB NOT NULL,
  PRIMARY KEY (`SESSION_PRIMARY_ID`, `ATTRIBUTE_NAME`),
  CONSTRAINT `SPRING_SESSION_ATTRIBUTES_FK` FOREIGN KEY (`SESSION_PRIMARY_ID`) REFERENCES `SPRING_SESSION` (`PRIMARY_ID`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;




CREATE TABLE employee (
    id INT PRIMARY KEY AUTO_INCREMENT ,
    qswar_id VARCHAR(20),
    gov_emp_id VARCHAR(20) UNIQUE COMMENT 'Government Employee ID (e.g., Aadhar, Handicraft ID)',
    name VARCHAR(100),
    username VARCHAR(100),
    phone VARCHAR(20),
    email VARCHAR(100) UNIQUE,
    position VARCHAR(50),
    authorised VARCHAR(255),
    department VARCHAR(50),
    password VARCHAR(255) NOT NULL,
    manager_emp_id INT,
    user_photo_link VARCHAR(512),
    FOREIGN KEY (manager_emp_id) REFERENCES employee(id)
);

CREATE TABLE visit (
    visit_id INT PRIMARY KEY AUTO_INCREMENT,
    emp_id INT,
    title VARCHAR(255),
    purpose TEXT,
    place VARCHAR(100),
    location VARCHAR(255),
    start DATE,
    end DATE,
    visit_status VARCHAR(50),
    manager_approval VARCHAR(50) COMMENT 'e.g., Pending, Approved, Rejected',
    visit_icon_link VARCHAR(512),
    FOREIGN KEY (emp_id) REFERENCES employee(id)
);

CREATE TABLE itinerary (
    itinerary_id INT PRIMARY KEY AUTO_INCREMENT,
    visit_id INT,
    payment_type VARCHAR(50),
    payment_status VARCHAR(50),
    itinerary_status VARCHAR(50),
    manager_approval VARCHAR(50) COMMENT 'e.g., Pending, Approved, Rejected',
    FOREIGN KEY (visit_id) REFERENCES visit(visit_id)
);

CREATE TABLE hotel (
    hotel_id INT PRIMARY KEY AUTO_INCREMENT,
    itinerary_id INT,
    name VARCHAR(100),
    location VARCHAR(255),
    checkin DATETIME,
    checkout DATETIME,
    category VARCHAR(50) COMMENT 'e.g., 3-star, 5-star',
    total_guest INT,
    males INT,
    females INT,
    childs INT,
    cost DECIMAL(10, 2),
    booking_id VARCHAR(50),
    booking_link VARCHAR(255),
    booking_status VARCHAR(50),
    manager_approval VARCHAR(50) COMMENT 'e.g., Pending, Approved, Rejected',
    FOREIGN KEY (itinerary_id) REFERENCES itinerary(itinerary_id)
);


CREATE TABLE travel (
    travel_id INT PRIMARY KEY AUTO_INCREMENT,
    itinerary_id INT,
    travel_type VARCHAR(50) COMMENT 'e.g., Flight, Train, Car',
    `from` VARCHAR(100),
    `to` VARCHAR(100),
    start DATETIME,
    `end` DATETIME,
    total_guest INT,
    males INT,
    females INT,
    childs INT,
    cost DECIMAL(10, 2),
    booking_id VARCHAR(50),
    booking_link VARCHAR(255),
    booking_status VARCHAR(50),
    manager_approval VARCHAR(50) COMMENT 'e.g., Pending, Approved, Rejected',
    FOREIGN KEY (itinerary_id) REFERENCES itinerary(itinerary_id)
);


CREATE TABLE closer_report (
    cr_id INT PRIMARY KEY AUTO_INCREMENT,
    visit_id INT,
    doc_type VARCHAR(50) COMMENT 'e.g., Report, Presentation, Invoice',
    doc_sub_type VARCHAR(50),
    title VARCHAR(255),
    details TEXT,
    doc_link VARCHAR(255),
    description TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    manager_feedback TEXT,
    manager_approval VARCHAR(50) COMMENT 'e.g., Pending, Approved, Rejected',
    FOREIGN KEY (visit_id) REFERENCES visit(visit_id)
);


create database hc;
use hc;


drop table closer_report;
drop table travel;
drop table hotel;
drop table itinerary;
drop table visit;
drop table employee;
